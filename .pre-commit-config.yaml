# Copyright (c) 2022 Graphcore Ltd. All rights reserved.
---
repos:
    - repo: local
      hooks:
          - id: version-checker
            name: Version checker
            description: Ensures that the correct version of the linters are used.
            entry: python3 -m scripts.lint.install.check_versions
            language: python
            exclude: ".*"  # Does not run on files
            always_run: true
            additional_dependencies:
                - pyyaml
          - id: copyright-linter
            name: Copyright linter
            description: Ensures that files have the proper copyright line.
            entry: python3 -m scripts.lint.linters.copyright_linter
            language: python
            exclude: |
                (?x)^(
                    LICENSE|
                    build_scripts/.*|
                    willow/include/popart/vendored/.*|
                    .arclint|
                    .arcconfig|
                    .buildignore|
                    .clang-format|
                    .style.yapf|
                    .*Doxyfile.in|
                    .*.drawio|
                    .*.json|
                    .*.md|
                    .*.png|
                    .*.pdf|
                    .*.rst
                )$
            additional_dependencies:
                # dataclasses was introduced in Python 3.7
                # For python 3.6 it therefore needs to be added as a dependency
                - dataclasses
          - id: popart-test-linter
            name: PopART test-linter
            description: |
              checks that pytest test files have a corresponding
              `add_popart_py_unit_test` entry in a neighbouring CMakeLists.txt
              file
            entry: tests/popart_test_linter/check_test_has_cmake_entry.py
            language: python
            files: .*.py
            exclude: |
                (?x)^(
                    docs/user_guide/files/tests/test_examples.py|
                    tests/linters/.*
                )$
    # The following linters are currently disabled
    # -   repo: https://github.com/pre-commit/pre-commit-hooks
    #     rev: v2.3.0
    #     hooks:
    #     -   id: check-yaml
    #     -   id: check-json
    #     -   id: check-merge-conflict
    #     -   id: debug-statements
    #     -   id: end-of-file-fixer
    #     -   id: mixed-line-ending
    #     -   id: trailing-whitespace
    # - repo: https://github.com/pre-commit/mirrors-yapf
    #   rev: v0.27.0
    #   hooks:
    #       - id: yapf
    # - repo: https://github.com/pocc/pre-commit-hooks
    #   rev: v1.3.5
    #   hooks:
    #       # Install with pip3 install clang-format==9.0.0
    #       - id: clang-format
    #         exclude: willow/include/popart/vendored/
    #         args: [
    #             -i,  # Fix inplace
    #             --style=file  # Use .clang-tidy
    #         ]
    #      - id: clang-tidy
    #      - id: oclint
    #      - id: uncrustify
    #      - id: cppcheck
    #        exclude: willow/include/popart/vendored/
    #        args: [
    #            --suppressions-list=scripts/lint/linters/cppcheck-suppressions-list.txt
    #        ]
    #      - id: cpplint
    #      - id: include-what-you-use
